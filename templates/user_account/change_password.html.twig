{% extends 'base.html.twig' %}

{% block title %}Changer le mot de passe - Bibliothèque{% endblock %}

{% block body %}
<div class="container py-5">
    <div class="row">
        <div class="col-md-6 offset-md-3">
            <h1 class="mb-4">Changer le mot de passe</h1>

            {% if app.flashes %}
                {% for type, messages in app.flashes %}
                    {% for message in messages %}
                        <div class="alert alert-{{ type == 'danger' ? 'danger' : (type == 'warning' ? 'warning' : 'success') }} alert-dismissible fade show" role="alert">
                            {{ message }}
                            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                        </div>
                    {% endfor %}
                {% endfor %}
            {% endif %}

            <div class="card">
                <div class="card-body">
                    {{ form_start(form) }}
                        <div class="mb-3">
                            {{ form_label(form.currentPassword, 'Mot de passe actuel') }}
                            {{ form_widget(form.currentPassword) }}
                            {{ form_errors(form.currentPassword) }}
                        </div>

                        <hr class="my-4">

                        <div class="mb-3">
                            {{ form_label(form.plainPassword, 'Nouveau mot de passe') }}
                            {{ form_widget(form.plainPassword) }}
                            {{ form_errors(form.plainPassword) }}
                            <small class="form-text text-muted d-block mt-2">
                                <strong>Conditions du mot de passe :</strong>
                                <ul class="mb-0 mt-2">
                                    <li>Au moins 8 caractères</li>
                                    <li>Contient une lettre majuscule (A-Z)</li>
                                    <li>Contient une lettre minuscule (a-z)</li>
                                    <li>Contient au moins un chiffre (0-9)</li>
                                </ul>
                            </small>
                        </div>

                        <div class="mb-3">
                            {{ form_label(form.confirmPassword, 'Confirmer le nouveau mot de passe') }}
                            {{ form_widget(form.confirmPassword) }}
                            {{ form_errors(form.confirmPassword) }}
                        </div>

                        <div class="d-flex gap-2">
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-save"></i> Changer le mot de passe
                            </button>
                            <a href="{{ path('app_user_profile') }}" class="btn btn-secondary">
                                <i class="fas fa-times"></i> Annuler
                            </a>
                        </div>
                    {{ form_end(form) }}
                </div>
            </div>

            <div class="alert alert-info mt-4" role="alert">
                <strong>Conseil :</strong> Pour votre sécurité, assurez-vous que votre nouveau mot de passe est différent du mot de passe actuel et utilisez une combinaison de majuscules, minuscules et chiffres.
            </div>
        </div>
    </div>
</div>
{% endblock %}
